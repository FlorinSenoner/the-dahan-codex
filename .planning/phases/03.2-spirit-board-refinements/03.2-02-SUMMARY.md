---
phase: 03.2-spirit-board-refinements
plan: 02
subsystem: ui
tags: [react, intersection-observer, tabs, scroll-detection, collapsible]

# Dependency graph
requires:
  - phase: 03.2-01
    provides: react-intersection-observer package installed
provides:
  - Minimalist tab styling with flat border-b-2 indicator
  - Scroll-aware header showing aspect name when tabs hidden
  - Conditional tab rendering for spirits with/without aspects
  - Pills extracted below spirit name (always visible)
  - Description moved into collapsible overview section
affects: [03.2-03, 03.2-04]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - useInView hook for scroll detection with rootMargin offset
    - Visibility callback pattern for parent-child communication
    - Props-based conditional rendering for optional UI

key-files:
  created: []
  modified:
    - app/components/spirits/variant-tabs.tsx
    - app/routes/spirits.$slug.tsx
    - app/components/spirits/overview-section.tsx

key-decisions:
  - "Flat border-b-2 indicator instead of gradient background for cleaner tabs"
  - "rootMargin -57px for header height offset in scroll detection"
  - "Pills always visible below name, description inside collapsible"

patterns-established:
  - "useInView with onVisibilityChange callback for scroll-aware UI"
  - "Conditional component rendering based on data presence (aspects.length)"

# Metrics
duration: 5min
completed: 2026-01-26
---

# Phase 3.2 Plan 2: Minimalist Tabs with Scroll Sync Summary

**Flat border-b-2 tab indicator with scroll-aware header aspect display and pills extracted below spirit name**

## Performance

- **Duration:** 5 min
- **Started:** 2026-01-26T23:31:39Z
- **Completed:** 2026-01-26T23:36:45Z
- **Tasks:** 3
- **Files modified:** 3

## Accomplishments

- Replaced gradient tab background with clean flat border-b-2 indicator
- Added scroll detection using useInView to track when tabs leave viewport
- Header now shows aspect name subtitle when tabs are scrolled out of view
- Conditional rendering of VariantTabs only when spirit has aspects
- Extracted complexity and element pills to always be visible below spirit name
- Moved description text into collapsible overview section

## Task Commits

Each task was committed atomically:

1. **Task 1: Update variant-tabs with minimalist styling and scroll detection** - `fc69341` (feat)
2. **Task 2: Add conditional tab rendering and header aspect name** - `f007b05` (feat)
3. **Task 3: Extract pills below name and move description into overview** - `4078c94` (feat)

## Files Created/Modified

- `app/components/spirits/variant-tabs.tsx` - Added useInView scroll detection, onVisibilityChange callback, flat border styling
- `app/routes/spirits.$slug.tsx` - Added tabs visibility state, header aspect name display, pills below name, conditional tab rendering
- `app/components/spirits/overview-section.tsx` - Removed complexity/elements (now in main content), added description prop

## Decisions Made

- Used rootMargin: "-57px 0px 0px 0px" to account for sticky header height when detecting tab visibility
- useCallback for handleVisibilityChange to prevent unnecessary re-renders
- Pills placed directly after spirit name with flex-wrap for proper mobile layout

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Tab styling and scroll behavior complete
- Ready for 03.2-03: Complex Spirit Data (Bringer, Sharp Fangs, Fractured Days)
- All success criteria met:
  - Gradient removed, flat border-b-2 active indicator
  - Tabs sticky at top-[57px], scroll behind header
  - useInView detects viewport changes
  - Header shows aspect name when tabs hidden
  - 44px touch targets maintained
  - Pills below name, description in collapsible

---
*Phase: 03.2-spirit-board-refinements*
*Completed: 2026-01-26*

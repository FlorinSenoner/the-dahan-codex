---
phase: 03.2-spirit-board-refinements
plan: 04
subsystem: ui
tags: [react, tailwind, collapsible, spirit-colors, presence-tracks]

# Dependency graph
requires:
  - phase: 03.2-01
    provides: getSpiritTrackColors, trackGradientClasses, spirit-colors.ts infrastructure
provides:
  - Spirit-specific presence track colors (cyan/amber for River, orange/violet for Lightning)
  - Collapsible cards section with Hand subsection
  - Border-only speed indicator pattern for power cards
  - Multi-track support with color cycling fallback
affects: [03.2-e2e, opening-scrubber, complex-spirits]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Spirit identity colors via getSpiritTrackColors(slug)"
    - "Border-l-4 for speed indication (amber=Fast, blue=Slow)"
    - "Collapsible sections with count badges"
    - "Truncate with title attribute for accessibility"

key-files:
  created: []
  modified:
    - app/components/spirits/presence-track.tsx
    - app/components/spirits/presence-slot.tsx
    - app/components/spirits/card-hand.tsx
    - app/routes/spirits.$slug.tsx

key-decisions:
  - "Extended trackColor type to support all spirit-specific colors (cyan, orange, violet, indigo, stone)"
  - "Use border-l-4 instead of badge for speed indication - cleaner visual"
  - "Grid layout (1-col mobile, 2-col desktop) instead of horizontal scroll for cards"
  - "Added connectsTo (GitBranch icon) and unlocksGrowth (Sprout icon) visual indicators"

patterns-established:
  - "spiritSlug prop pattern: pass spirit.slug to components needing spirit-specific theming"
  - "Collapsible section header format: icon + label + count badge"

# Metrics
duration: 3min
completed: 2026-01-26
---

# Phase 3.2 Plan 04: Presence Tracks & Cards Polish Summary

**Spirit-specific presence track colors via getSpiritTrackColors and collapsible cards section with border-only speed indicators**

## Performance

- **Duration:** 3 min
- **Started:** 2026-01-26T23:31:47Z
- **Completed:** 2026-01-26T23:34:03Z
- **Tasks:** 2
- **Files modified:** 4

## Accomplishments

- Presence tracks now use spirit-specific gradient colors (River: cyan/amber, Lightning: orange/violet)
- Added visual indicators for connectsTo (branching tracks) and unlocksGrowth (Starlight)
- Cards section redesigned with collapsible Hand subsection showing card count
- Power cards use border-l-4 for speed indication instead of text badge
- Equal-width cards in grid layout with truncation for long names

## Task Commits

Each task was committed atomically:

1. **Task 1: Update presence tracks with spirit-specific colors** - `739a9a1` (feat)
2. **Task 2: Add collapsible Hand/Discard sections to cards** - `7db46e1` (feat)

## Files Created/Modified

- `app/components/spirits/presence-track.tsx` - Spirit-specific color lookup via getSpiritTrackColors, connectsTo/unlocksGrowth indicators
- `app/components/spirits/presence-slot.tsx` - Extended trackColor type for new colors
- `app/components/spirits/card-hand.tsx` - Collapsible Hand section, border-only speed, grid layout
- `app/routes/spirits.$slug.tsx` - Pass spiritSlug prop to PresenceTrack

## Decisions Made

- **Extended color palette:** Added cyan, orange, violet, indigo, stone to PresenceSlot trackColor type to support all spirit mappings
- **Border-only speed:** Removed Fast/Slow text badge - border-l-4 is sufficient and cleaner
- **Grid over scroll:** Cards now use 2-column grid on desktop instead of horizontal scroll - better for viewing all cards
- **Visual indicators:** GitBranch icon for connectsTo, Sprout icon for unlocksGrowth - subtle but informative

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] Extended PresenceSlot trackColor type**
- **Found during:** Task 1 (presence track colors)
- **Issue:** PresenceSlot trackColor only accepted "amber" | "blue" | "purple" | "emerald", but spirit-colors maps include cyan, orange, violet, indigo, stone
- **Fix:** Extended trackColor union type and added corresponding borderColors/hoverBorderColors mappings
- **Files modified:** app/components/spirits/presence-slot.tsx
- **Verification:** TypeScript compiles without errors
- **Committed in:** 739a9a1 (Task 1 commit)

---

**Total deviations:** 1 auto-fixed (1 blocking)
**Impact on plan:** Essential fix to make spirit-specific colors work. No scope creep.

## Issues Encountered

None - both tasks executed smoothly after the type fix.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Presence tracks display spirit identity through color
- Cards section properly organized with collapsible headers
- Ready for E2E testing and visual verification
- Complex spirits (Finder, Starlight, Serpent) have placeholder indicators for their special track mechanics

---
*Phase: 03.2-spirit-board-refinements*
*Completed: 2026-01-26*

---
phase: 02.1-spirit-library-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - convex/schema.ts
  - convex/seed.ts
autonomous: true

must_haves:
  truths:
    - "Aspects have complexityModifier field (easier/same/harder)"
    - "Spirits have description field for detailed playstyle text"
    - "Lightning's Swift Strike has Immense aspect"
    - "All aspects have correct complexityModifier values"
  artifacts:
    - path: "convex/schema.ts"
      provides: "complexityModifier and description fields"
      contains: "complexityModifier"
    - path: "convex/seed.ts"
      provides: "Complete seed data with all aspects"
      contains: "Immense"
  key_links:
    - from: "convex/seed.ts"
      to: "convex/schema.ts"
      via: "schema field usage"
      pattern: "complexityModifier.*harder"
---

<objective>
Add complexity modifier and description fields to spirit schema, add missing Immense aspect, and fix all aspect data to include complexity modifiers.

Purpose: UAT identified missing Immense aspect and no complexity modifiers for aspects. The schema needs additional fields to support the aspect complexity modifier display (up/down arrows) and longer description text on detail pages.

Output: Updated schema.ts with new fields, updated seed.ts with complete data including Immense aspect and all complexity modifiers.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.1-spirit-library-polish/02.1-RESEARCH.md

@convex/schema.ts
@convex/seed.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add complexityModifier and description fields to schema</name>
  <files>convex/schema.ts</files>
  <action>
Add two new optional fields to the spirits table in convex/schema.ts:

1. `complexityModifier` - For aspects to indicate relative complexity:
   ```typescript
   complexityModifier: v.optional(v.union(
     v.literal("easier"),
     v.literal("same"),
     v.literal("harder"),
   )),
   ```

2. `description` - Longer text for spirit detail page (theme + playstyle):
   ```typescript
   description: v.optional(v.string()),
   ```

Add these fields after the existing `aspectName` field. Keep the schema clean and well-commented.
  </action>
  <verify>Run `npx convex dev --once` to validate schema changes. Check for TypeScript errors.</verify>
  <done>Schema has complexityModifier (easier/same/harder) and description fields. Convex accepts the schema.</done>
</task>

<task type="auto">
  <name>Task 2: Add Immense aspect and fix all aspect data</name>
  <files>convex/seed.ts</files>
  <action>
Update the seed mutation to include complete aspect data:

1. Add Immense aspect for Lightning's Swift Strike:
   - aspectName: "Immense"
   - complexityModifier: "harder"
   - summary: "Massive presence with devastating area attacks."
   - expansion: Add "Promo Pack 2" expansion (releaseYear: 2021)

2. Add complexityModifier to ALL existing aspects:
   - All Lightning aspects: "harder" (Pandemonium, Sparking, Wind, Immense)
   - All River aspects: "harder" (Sunshine, Travel, Haven)

3. Add description field to base spirits (detailed playstyle):
   - River: "River is a flexible spirit that excels at moving Invaders and Dahan around the island. With strong energy generation and the ability to heal Blight, River supports other spirits while steadily pushing back the invasion. Best played reactively, responding to threats across multiple lands."
   - Lightning: "Lightning is an aggressive spirit focused on dealing damage quickly in the fast phase before Invaders can build. With low defense but high offense, Lightning races to destroy towns and explorers before they establish. Best played proactively, targeting the most dangerous lands early."

4. Keep aspects' base complexity field matching the base spirit (Low for both River and Lightning aspects) - the complexityModifier is for display, filtering still uses base complexity.

**Important:** The seed is idempotent - it skips if data exists. Consider whether to add a force reseed flag or document manual reseed via Convex dashboard.
  </action>
  <verify>Run `npx convex dev --once` then check Convex dashboard data tab to verify Immense aspect exists and all aspects have complexityModifier values.</verify>
  <done>Seed data includes Immense aspect, all 7 aspects have complexityModifier: "harder", base spirits have description field.</done>
</task>

<task type="auto">
  <name>Task 3: Create reseed mutation and run it</name>
  <files>convex/seed.ts</files>
  <action>
Add a `reseedSpirits` mutation that:
1. Deletes all existing spirits and expansions
2. Calls the same seeding logic as seedSpirits

This allows re-running the seed with updated data.

Then run: `npx convex run seed:reseedSpirits` to apply the new data.

Alternatively, if simpler, just document that users should:
1. Go to Convex dashboard
2. Delete all rows from spirits and expansions tables
3. Run `npx convex run seed:seedSpirits`
  </action>
  <verify>Run `npx convex run seed:reseedSpirits` (or manual reseed). Verify in Convex dashboard that Lightning has 4 aspects (Immense, Pandemonium, Sparking, Wind) and all have complexityModifier.</verify>
  <done>Database contains updated seed data with Immense aspect and complexity modifiers.</done>
</task>

</tasks>

<verification>
- `npx convex dev --once` runs without schema errors
- Convex dashboard shows spirits table with complexityModifier and description columns
- Lightning's Swift Strike has 4 aspects including Immense
- All aspects have complexityModifier: "harder"
- Base spirits have description field populated
</verification>

<success_criteria>
- Schema updated with complexityModifier (optional union) and description (optional string)
- Seed data includes Immense aspect for Lightning
- All 7 aspects have complexityModifier: "harder"
- Base spirits have detailed description text
- Data is live in Convex database
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-spirit-library-polish/02.1-01-SUMMARY.md`
</output>

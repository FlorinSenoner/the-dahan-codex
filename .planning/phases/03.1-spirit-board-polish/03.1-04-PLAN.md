---
phase: 03.1-spirit-board-polish
plan: 04
type: execute
wave: 2
depends_on: ["03.1-01", "03.1-02"]
files_modified:
  - app/components/spirits/growth-panel.tsx
  - app/components/icons/growth/index.ts
  - app/components/icons/growth/reclaim.tsx
  - app/components/icons/growth/energy.tsx
  - app/components/icons/growth/power-card.tsx
  - app/components/icons/growth/presence.tsx
autonomous: true

must_haves:
  truths:
    - "Growth panel displays G1/G2/G3 options with correct data"
    - "Each growth option shows individual action icons"
    - "Actions use SVG icons for visual clarity"
    - "G1/G2/G3 labels visible on hover"
  artifacts:
    - path: "app/components/spirits/growth-panel.tsx"
      provides: "Redesigned growth panel with card-based layout and icons"
      contains: "growth.options"
    - path: "app/components/icons/growth/index.ts"
      provides: "Growth action SVG icons"
      exports: ["ReclaimIcon", "EnergyIcon", "PowerCardIcon", "PresenceIcon"]
  key_links:
    - from: "app/components/spirits/growth-panel.tsx"
      to: "convex/schema.ts"
      via: "Growth options array with typed actions"
      pattern: "growth\\.options"
    - from: "app/components/spirits/growth-panel.tsx"
      to: "app/components/icons/growth"
      via: "SVG icons for action types"
      pattern: "import.*icons/growth"
---

<objective>
Redesign the growth panel component to display correct G1/G2/G3 options with SVG icons for each action type, replacing the incorrect "Top/Bottom" grouping.

Purpose: The current growth panel shows wrong data structure (Top/Bottom) and uses plain text for actions. Users need accurate Spirit Island growth options with visual iconography.

Output:
- Growth action icons (reclaim, energy, power card, presence)
- Redesigned growth panel with card layout and G1/G2/G3 labels
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03.1-spirit-board-polish/03.1-RESEARCH.md
@.planning/phases/03.1-spirit-board-polish/03.1-01-SUMMARY.md
@.planning/phases/03.1-spirit-board-polish/03.1-02-SUMMARY.md
@app/components/spirits/growth-panel.tsx
@app/lib/power-dsl.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Growth Action SVG Icons</name>
  <files>
    app/components/icons/growth/index.ts
    app/components/icons/growth/reclaim.tsx
    app/components/icons/growth/energy.tsx
    app/components/icons/growth/power-card.tsx
    app/components/icons/growth/presence.tsx
  </files>
  <action>
Create growth action SVG icons in app/components/icons/growth/:

1. Create directory `app/components/icons/growth/`

2. Shared interface (same as element icons):
```typescript
interface GrowthIconProps extends React.SVGProps<SVGSVGElement> {
  size?: number;
}
```

3. Create icons with Spirit Island-inspired designs:

reclaim.tsx - Circular arrow (reclaim cards):
- Circle with curved arrow returning to start
- Default color: amber (matches Spirit Island)

energy.tsx - Lightning bolt or energy symbol:
- Simple lightning bolt shape
- Default color: amber/yellow

power-card.tsx - Card shape:
- Rectangle with corner fold (card representation)
- Default color: blue

presence.tsx - Circle or disc (presence token):
- Simple filled circle
- Default color: white/neutral

4. Barrel export in index.ts:
```typescript
export { ReclaimIcon } from "./reclaim";
export { EnergyIcon } from "./energy";
export { PowerCardIcon } from "./power-card";
export { PresenceIcon } from "./presence";

export const GrowthIcon: Record<string, React.FC<GrowthIconProps>> = {
  reclaim: ReclaimIcon,
  gainEnergy: EnergyIcon,
  gainPowerCard: PowerCardIcon,
  addPresence: PresenceIcon,
};
```

All icons should:
- Default size: 20px
- Use currentColor for fill
- Accept className for color override
  </action>
  <verify>
Run `pnpm typecheck` - no errors in growth icons directory.
  </verify>
  <done>
Growth action icons created: reclaim, energy, power card, presence with consistent API.
  </done>
</task>

<task type="auto">
  <name>Task 2: Redesign Growth Panel Component</name>
  <files>app/components/spirits/growth-panel.tsx</files>
  <action>
Completely redesign growth-panel.tsx to use new schema structure:

1. Update interface to match new schema:
```typescript
interface GrowthPanelProps {
  growth: {
    type?: "pick-one" | "pick-two";
    options: Array<{
      id: string;
      cost?: number;
      actions: Array<{
        type: string;
        variant?: string;
        amount?: number;
        cardType?: string;
        range?: number;
        terrain?: string;
        count?: number;
        pieceType?: string;
        target?: string;
        element?: string;
      }>;
    }>;
  };
}
```

2. Create GrowthOption component for each option card:
```typescript
function GrowthOption({ option, index }: { option: GrowthOption; index: number }) {
  return (
    <Card className="bg-muted/30 group relative">
      {/* G1/G2/G3 label - visible on hover */}
      <div className="absolute -top-2 -left-2 opacity-0 group-hover:opacity-100 transition-opacity">
        <Badge variant="secondary" className="text-xs">
          {option.id}
        </Badge>
      </div>

      <CardContent className="p-3 flex flex-wrap gap-2">
        {option.actions.map((action, idx) => (
          <GrowthActionBadge key={`${action.type}-${idx}`} action={action} />
        ))}
      </CardContent>
    </Card>
  );
}
```

3. Create GrowthActionBadge component to render each action with icon:
```typescript
function GrowthActionBadge({ action }: { action: GrowthAction }) {
  const Icon = GrowthIcon[action.type];
  const label = formatGrowthActionShort(action);

  return (
    <div className="flex items-center gap-1.5 px-2 py-1 rounded-md bg-background/50 border border-border/50">
      {Icon && <Icon size={16} className="text-primary" />}
      <span className="text-xs text-muted-foreground">{label}</span>
    </div>
  );
}
```

4. Format function for short action labels:
```typescript
function formatGrowthActionShort(action: GrowthAction): string {
  switch (action.type) {
    case "reclaim":
      return action.variant === "all" ? "Reclaim All" : "Reclaim One";
    case "gainEnergy":
      return `+${action.amount} Energy`;
    case "gainPowerCard":
      return action.cardType ? `Gain ${action.cardType}` : "Gain Card";
    case "addPresence":
      const terrain = action.terrain ? ` (${action.terrain})` : "";
      return `+Presence R${action.range}${terrain}`;
    // ... other action types
  }
}
```

5. Main component layout:
```typescript
export function GrowthPanel({ growth }: GrowthPanelProps) {
  if (!growth?.options?.length) {
    return <EmptyState />;
  }

  return (
    <section className="space-y-3">
      <div className="flex items-center gap-2">
        <Heading variant="h3" as="h2">Growth</Heading>
        {growth.type && (
          <Badge variant="outline" className="text-xs">
            {growth.type === "pick-two" ? "Pick Two" : "Pick One"}
          </Badge>
        )}
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
        {growth.options.map((option, idx) => (
          <GrowthOption key={option.id} option={option} index={idx} />
        ))}
      </div>
    </section>
  );
}
```

6. Handle backward compatibility - if data is old format, show fallback message.
  </action>
  <verify>
Run `pnpm dev` and navigate to /spirits/river-surges-in-sunlight.
Verify: 3 growth options shown (G1, G2, G3), each with action icons, G1/G2/G3 visible on hover.
  </verify>
  <done>
Growth panel displays G1/G2/G3 options with SVG icons for each action type. Labels visible on hover.
  </done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. Growth panel shows 3 options for River (not 2)
3. Each option displays action icons (reclaim, energy, card, presence)
4. G1/G2/G3 labels appear on hover
5. Action text is concise and readable
</verification>

<success_criteria>
- Growth panel UAT issues resolved: correct G1/G2/G3 data, SVG icons, hover labels
- Actions display with icons matching Spirit Island iconography
- Component uses new schema structure from Plan 02
- Backward compatible with fallback for old data format
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-spirit-board-polish/03.1-04-SUMMARY.md`
</output>

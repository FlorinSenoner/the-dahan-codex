# Plan 06.2-02: Convex Query Helper

## Goal

Extract base spirit lookup helper in spirits.ts to eliminate query duplication.

## Tasks

1. Create helper function `getBaseSpiritBySlug` in convex/spirits.ts
2. Update getSpiritWithAspects to use helper
3. Update getSpiritBySlug to use helper

## Implementation

```typescript
// convex/spirits.ts

const getBaseSpiritBySlug = async (ctx: QueryCtx, slug: string) => {
  return ctx.db
    .query("spirits")
    .withIndex("by_slug", (q) => q.eq("slug", slug))
    .filter((q) => q.eq(q.field("baseSpirit"), undefined))
    .first();
};
```

## Verification

```bash
pnpm typecheck
pnpm jscpd convex/spirits.ts
```

## Files Changed

- convex/spirits.ts

# Plan 06.2-05: Game Form Payload Utility

## Goal

Extract game form â†’ mutation payload transformation used in $id.tsx and new.tsx.

## Tasks

1. Create app/lib/game-form-utils.ts with transformGameFormData function
2. Update new.tsx to use shared utility
3. Update $id.tsx to use shared utility

## Implementation

```typescript
// app/lib/game-form-utils.ts

export function transformGameFormData(data: GameFormData) {
  const validSpirits = data.spirits.filter((s) => s.name.trim());
  return {
    date: data.date,
    result: data.result,
    spirits: validSpirits.map((s) => ({
      spiritId: s.spiritId ?? undefined,
      name: s.name,
      variant: s.variant,
      player: s.player,
    })),
    adversary: data.adversary,
    secondaryAdversary: data.secondaryAdversary,
    scenario: data.scenario,
    board: data.board || undefined,
    notes: data.notes || undefined,
    score: data.score,
  };
}
```

## Verification

```bash
pnpm typecheck
pnpm jscpd app/routes/_authenticated/games/
```

## Files Changed

- app/lib/game-form-utils.ts (new)
- app/routes/_authenticated/games/$id.tsx
- app/routes/_authenticated/games/new.tsx

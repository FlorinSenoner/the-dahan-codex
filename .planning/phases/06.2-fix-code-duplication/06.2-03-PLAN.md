# Plan 06.2-03: Seed Data Consolidation

## Goal

Extract shared seed logic so reseedSpirits reuses seedSpirits helper functions.

## Tasks

1. Create `insertSeedData` helper function containing shared seeding logic
2. Create helper functions for expansion and spirit insertion
3. Update seedSpirits to use insertSeedData
4. Update reseedSpirits to use insertSeedData after clearing data

## Implementation

```typescript
// convex/seed.ts

async function insertSeedData(ctx: MutationCtx) {
  // Get or create expansions
  const expansions = await getOrCreateExpansions(ctx);

  // Insert all spirits (base + aspects)
  await insertSpirits(ctx, expansions);

  // Insert openings
  await insertOpenings(ctx);
}

export const seedSpirits = mutation({
  handler: async (ctx) => {
    await insertSeedData(ctx);
  },
});

export const reseedSpirits = mutation({
  handler: async (ctx) => {
    // Clear existing data
    await clearExistingData(ctx);
    // Reuse same insert logic
    await insertSeedData(ctx);
  },
});
```

## Verification

```bash
pnpm typecheck
pnpm jscpd convex/seed.ts
```

## Files Changed

- convex/seed.ts

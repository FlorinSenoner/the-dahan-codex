---
phase: 05-text-opening-management
plan: 12
type: execute
wave: 2
depends_on: []
files_modified:
  - app/components/ui/alert-dialog.tsx
  - app/components/admin/editable-opening.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Delete opening uses themed AlertDialog modal"
    - "Delete turn uses themed AlertDialog modal"
    - "No browser confirm() dialogs for delete actions"
    - "Modal matches app theme and styling"
  artifacts:
    - path: "app/components/ui/alert-dialog.tsx"
      provides: "Themed AlertDialog component"
      contains: "AlertDialog"
    - path: "app/components/admin/editable-opening.tsx"
      provides: "Delete modals for opening and turns"
      contains: "AlertDialog"
  key_links:
    - from: "app/components/admin/editable-opening.tsx"
      to: "app/components/ui/alert-dialog.tsx"
      via: "AlertDialog import"
      pattern: "import.*AlertDialog"
---

<objective>
Replace browser confirm() dialogs with themed AlertDialog modals for all delete actions.

Purpose: Consistent UI experience with app theme, better UX than browser dialogs
Output: Delete opening and delete turn both use shadcn AlertDialog component
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-text-opening-management/05-VERIFICATION.md

GAP-06 and GAP-07 from VERIFICATION.md:
- User must click delete twice - once on button, once on browser confirm
- Browser confirm() dialogs don't match app theme
Replace with themed AlertDialog modal for both delete opening and delete turn.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add AlertDialog component from shadcn</name>
  <files>app/components/ui/alert-dialog.tsx</files>
  <action>
  Generate the shadcn AlertDialog component.

  Run: `npx shadcn@latest add alert-dialog`

  This will create app/components/ui/alert-dialog.tsx with:
  - AlertDialog (root)
  - AlertDialogTrigger
  - AlertDialogContent
  - AlertDialogHeader
  - AlertDialogFooter
  - AlertDialogTitle
  - AlertDialogDescription
  - AlertDialogAction
  - AlertDialogCancel

  The component will be styled to match the existing theme.
  </action>
  <verify>
  File exists: app/components/ui/alert-dialog.tsx
  Run `pnpm typecheck` - compiles
  </verify>
  <done>AlertDialog component available in UI library</done>
</task>

<task type="auto">
  <name>Task 2: Replace confirm dialogs with AlertDialog</name>
  <files>app/components/admin/editable-opening.tsx</files>
  <action>
  Replace both browser confirm() calls with AlertDialog:

  1. Delete Turn (line ~59):
  Current: `if (!confirm("Delete this turn?")) return;`
  New: Use AlertDialog with state management

  2. Delete Opening (lines ~189-194):
  Current: `if (confirm("Delete this opening? This cannot be undone.")) { onDelete(); }`
  New: Use AlertDialog with state management

  Implementation pattern:
  ```tsx
  import {
    AlertDialog,
    AlertDialogAction,
    AlertDialogCancel,
    AlertDialogContent,
    AlertDialogDescription,
    AlertDialogFooter,
    AlertDialogHeader,
    AlertDialogTitle,
    AlertDialogTrigger,
  } from "@/components/ui/alert-dialog";

  // For delete turn - use AlertDialogTrigger pattern:
  <AlertDialog>
    <AlertDialogTrigger asChild>
      <Button variant="ghost" size="icon" ...>
        <Trash2 ... />
      </Button>
    </AlertDialogTrigger>
    <AlertDialogContent>
      <AlertDialogHeader>
        <AlertDialogTitle>Delete Turn {turn.turn}?</AlertDialogTitle>
        <AlertDialogDescription>
          This action cannot be undone. The turn content will be permanently deleted.
        </AlertDialogDescription>
      </AlertDialogHeader>
      <AlertDialogFooter>
        <AlertDialogCancel>Cancel</AlertDialogCancel>
        <AlertDialogAction
          onClick={() => deleteTurn(index)}
          className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
        >
          Delete
        </AlertDialogAction>
      </AlertDialogFooter>
    </AlertDialogContent>
  </AlertDialog>

  // For delete opening - similar pattern:
  <AlertDialog>
    <AlertDialogTrigger asChild>
      <Button variant="destructive" size="sm">
        <Trash2 className="h-4 w-4 mr-2" />
        Delete Opening
      </Button>
    </AlertDialogTrigger>
    <AlertDialogContent>
      <AlertDialogHeader>
        <AlertDialogTitle>Delete Opening?</AlertDialogTitle>
        <AlertDialogDescription>
          This action cannot be undone. The opening "{formData.name || 'Untitled'}" and all its turns will be permanently deleted.
        </AlertDialogDescription>
      </AlertDialogHeader>
      <AlertDialogFooter>
        <AlertDialogCancel>Cancel</AlertDialogCancel>
        <AlertDialogAction
          onClick={() => onDelete?.()}
          className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
        >
          Delete
        </AlertDialogAction>
      </AlertDialogFooter>
    </AlertDialogContent>
  </AlertDialog>
  ```

  Note: The deleteTurn function no longer needs the confirm() call - remove it.
  The AlertDialogAction onClick will call the actual delete function.
  </action>
  <verify>
  Run `pnpm typecheck` - compiles
  Run `pnpm build` - builds successfully
  No references to `confirm(` remain in the file
  </verify>
  <done>All delete actions use themed AlertDialog modals</done>
</task>

</tasks>

<verification>
1. `pnpm typecheck` passes
2. `pnpm build` succeeds
3. grep -n "confirm(" app/components/admin/editable-opening.tsx returns no matches
4. Manual test: Click delete turn button - themed modal appears
5. Manual test: Click cancel in modal - modal closes, no deletion
6. Manual test: Click delete in modal - turn is deleted
7. Manual test: Same for delete opening button
</verification>

<success_criteria>
- AlertDialog component exists in UI library
- No browser confirm() dialogs in editable-opening.tsx
- Delete turn shows themed modal with cancel/confirm
- Delete opening shows themed modal with warning text
- Modal styling matches app theme
</success_criteria>

<output>
After completion, create `.planning/phases/05-text-opening-management/05-12-SUMMARY.md`
</output>

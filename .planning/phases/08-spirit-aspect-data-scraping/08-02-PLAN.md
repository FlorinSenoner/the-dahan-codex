---
phase: 08-spirit-aspect-data-scraping
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - scripts/scrape-aspects.ts
  - scripts/data/aspects.json
autonomous: true

must_haves:
  truths:
    - "Scraper fetches data for all 31 aspects from wiki"
    - "Each aspect linked to its base spirit slug"
    - "Complexity modifiers (easier/same/harder) captured for all aspects"
  artifacts:
    - path: "scripts/scrape-aspects.ts"
      provides: "Aspect scraper script"
      contains: "List_of_Aspect_Cards"
    - path: "scripts/data/aspects.json"
      provides: "Scraped aspect data cache"
      min_lines: 50
  key_links:
    - from: "scripts/scrape-aspects.ts"
      to: "spiritislandwiki.com"
      via: "https.get + cheerio parsing"
      pattern: "List_of_Aspect_Cards"
---

<objective>
Create an aspect scraper to fetch complete data for all 31 aspects from the Spirit Island wiki.

Purpose: Populate all spirit aspects with accurate data including complexity modifiers.
Output: scripts/data/aspects.json containing all aspect metadata ready for review.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-spirit-aspect-data-scraping/08-RESEARCH.md
@scripts/scrape-spirits.ts
@convex/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create aspect scraper with complete aspect list</name>
  <files>scripts/scrape-aspects.ts</files>
  <action>
Create scripts/scrape-aspects.ts with:

1. Copy utility functions from scrape-spirits.ts (fetchPage, downloadImage)

2. Define ScrapedAspect interface:
```typescript
interface ScrapedAspect {
  name: string;           // "Sunshine", "Pandemonium"
  baseSpiritSlug: string; // "river-surges-in-sunlight"
  slug: string;           // Full URL slug: "river-surges-in-sunlight-sunshine"
  summary: string;        // Brief description
  expansion: string;      // Expansion slug
  complexityModifier: "easier" | "same" | "harder";
  hasUniqueImage: boolean;
  wikiUrl: string;
  imagePattern?: string;  // If has unique image
}
```

3. Define ASPECTS constant with all 31 aspects from research:

| Spirit | Aspects |
|--------|---------|
| Lightning's Swift Strike | Pandemonium, Wind, Immense, Sparking |
| River Surges in Sunlight | Sunshine, Travel, Haven |
| Shadows Flicker Like Flame | Madness, Reach, Amorphous, Foreboding, Dark Fire |
| Vital Strength of the Earth | Resilience, Might, Nourishing |
| A Spread of Rampant Green | Regrowth, Tangles |
| Bringer of Dreams and Nightmares | Enticing, Violence |
| Heart of the Wildfire | Transforming |
| Keeper of the Forbidden Wilds | Spreading Hostility |
| Lure of the Deep Wilderness | Lair |
| Ocean's Hungry Grasp | Deeps |
| Serpent Slumbering Beneath the Island | Locus |
| Sharp Fangs Behind the Leaves | Encircle, Unconstrained |
| Shifting Memory of Ages | Intensify, Mentor |
| Shroud of Silent Mist | Stranded |
| Thunderspeaker | Tactician, Warrior |

4. Map base spirit names to slugs for linking
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit scripts/scrape-aspects.ts</verify>
  <done>ASPECTS constant defined with all 31 aspects and base spirit mappings</done>
</task>

<task type="auto">
  <name>Task 2: Scrape aspect data from wiki</name>
  <files>scripts/scrape-aspects.ts</files>
  <action>
Implement scraping from List of Aspect Cards page:
https://spiritislandwiki.com/index.php?title=List_of_Aspect_Cards

1. Fetch the aspects list page
2. Parse the table/list structure to extract:
   - Aspect name
   - Base spirit name
   - Expansion (derived from section headers or table columns)
   - Complexity modifier text (e.g., "increases complexity", "decreases complexity")

3. Map complexity text to enum:
   - "increases complexity" | "harder" | "more complex" -> "harder"
   - "decreases complexity" | "easier" | "less complex" -> "easier"
   - "no change" | "same complexity" | absent -> "same"

4. Also scrape individual aspect pages for:
   - Summary/description text
   - Check if unique aspect image exists

5. For each aspect, construct:
   - slug: `${baseSpiritSlug}-${aspectName.toLowerCase().replace(/\s+/g, '-')}`
   - wikiUrl: link to aspect's individual page

6. Add rate limiting (500ms between requests)
  </action>
  <verify>Run: npx tsx scripts/scrape-aspects.ts --test-one</verify>
  <done>Aspect scraper extracts complexity modifier, expansion, and summary from wiki</done>
</task>

<task type="auto">
  <name>Task 3: Output aspects to JSON and verify</name>
  <files>scripts/scrape-aspects.ts, scripts/data/aspects.json</files>
  <action>
1. Update main() to:
   - Scrape all 31 aspects
   - Write to scripts/data/aspects.json
   - Log progress and errors

2. Add CLI flags:
   - --test-one: scrape single aspect for testing
   - --dry-run: list what would be scraped

3. Run full scrape:
   ```bash
   npx tsx scripts/scrape-aspects.ts
   ```

4. Verify JSON output:
   - 31 aspect objects
   - Each has baseSpiritSlug, complexityModifier, expansion
   - No duplicates

5. Cross-reference with ASPECTS list to catch any missing
  </action>
  <verify>
Run: npx tsx scripts/scrape-aspects.ts
Check: cat scripts/data/aspects.json | jq length should output 31
Check: All aspects have complexityModifier field
  </verify>
  <done>scripts/data/aspects.json contains complete data for all 31 aspects</done>
</task>

</tasks>

<verification>
1. scripts/scrape-aspects.ts compiles without TypeScript errors
2. scripts/data/aspects.json exists with 31 aspect objects
3. All aspects have: name, baseSpiritSlug, complexityModifier, expansion
4. complexityModifier values are only "easier", "same", or "harder"
5. No duplicate aspects
6. All base spirit slugs match known spirit slugs from 08-01
</verification>

<success_criteria>
- All 31 aspects scraped from wiki
- Each aspect correctly linked to base spirit
- Complexity modifiers captured for all aspects
- Data saved to JSON for review
</success_criteria>

<output>
After completion, create `.planning/phases/08-spirit-aspect-data-scraping/08-02-SUMMARY.md`
</output>
